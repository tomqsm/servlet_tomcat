<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE urlrewrite PUBLIC "-//tuckey.org//DTD UrlRewrite 4.0//EN"
        "http://www.tuckey.org/res/dtds/urlrewrite4.0.dtd">
<urlrewrite use-context="false">
    <!--NOTE-->
    <!--conditions run first-->
    
    <!--LOGIN-->
    <rule enabled="true" match-type="regex">
        <name>loginFailureToCleanUrlEnglish</name>
        <note></note>
        <from>^(.*)/failed$</from>
        <set type="parameter" name="failed">true</set>
        <to type="forward" last="true">$1</to>
    </rule>
    <rule enabled="true" match-type="regex">
        <name>loginFailureToCleanUrlPolish</name>
        <note></note>
        <from>^(.*)/nieudane$</from>
        <set type="parameter" name="failed">true</set>
        <to type="forward" last="true">$1</to>
    </rule>
    
    <!--START LANGUAGE TO URL GROUP runs on / root call-->
<!--    <rule enabled="true" match-type="wildcard">
        <name>setSelectedLanguageFromBrowser</name>
        <condition type="method">GET</condition>
        <from>/</from>
        <run class="com.letsweb.tutorial.servlet_tomcat.rewriting.LocaleSetter" neweachtime="true"/>
    </rule>
    <rule enabled="true" match-type="wildcard">
        <name>ifSelectedLanguageFromBrowserIsNotPolish_Redirect</name>
        <condition type="method">GET</condition>
        <condition type="attribute" name="selectedLanguage" operator="notequal">/</condition>
        <from>/</from>
        <to type="temporary-redirect" last="false">%{context-path}%{attribute:selectedLanguage}indexservlet</to>
    </rule>
    <rule enabled="true" match-type="wildcard">
        <name>ifSelectedLanguageFromBrowserIsPolish_Forward</name>
        <condition type="method">GET</condition>
        <condition type="attribute" name="selectedLanguage" operator="equal">/</condition>
        <from>/</from>
        <to type="forward" last="true">%{attribute:selectedLanguage}indexservlet</to>
    </rule>-->
    <!-- END LANGUAGE TO URL GROUP-->

    <rule enabled="true" match-type="regex">
        <name>Index rule 1</name>
        <note>Set locale 2.</note>
        <from>^(/angielski|/en/angielski)$</from>Wszystkiego dobrego w 
        <to type="forward">indexservlet?tk=true</to>
    </rule>
    
    <outbound-rule enabled="true" match-type="regex">
        <name></name>
        <note></note>
        <condition type="parameter" name="tk" operator="equal">true</condition>
        <from>^angielski$</from>
        <to type="forward" last="true" qsappend="false">%{context-path}/en/indexservlet</to>
    </outbound-rule>
    
    <rule enabled="true" match-type="regex">
        <condition type="method">GET</condition>
        <from>^/$|^/en/$</from>
        <run class="com.letsweb.tutorial.servlet_tomcat.pages.LandingController" method="doGet" />
        <to type="forward" last="true">template.ftl</to>
    </rule>
    
    <rule enabled="true" match-type="regex">
        <condition type="method">GET</condition>
        <from>/links</from>
        <run class="com.letsweb.tutorial.servlet_tomcat.pages.LinksController" method="doGet" />
        <to type="forward">template.ftl</to>
    </rule>
    
    <rule enabled="true" match-type="regex">
        <condition type="method">GET</condition>
        <from>/podlogi|/floors|en/floors</from>
        <run class="com.letsweb.tutorial.servlet_tomcat.pages.LinksController" method="doGetPodlogi" />
        <to type="forward">template.ftl</to>
    </rule>

    
</urlrewrite>
